# errors.md — Foodgram (FastAPI)

> Цель: единый формат ошибок, совпадающий с фронтом и контрактом.

## Формат ошибок

* Общие: `{ "detail": "сообщение" }`
* Валидация: `{ "field": ["ошибка"] }`

## Коды

| Сущность       | Коды                            |
| -------------- | ------------------------------- |
| Auth           | 200/204, 400, 401               |
| Users          | 200, 401, 404                   |
| Recipes (CRUD) | 200/201/204, 400, 401, 403, 404 |
| Favorites/Cart | 201/204, 400, 401, 404          |
| Download cart  | 200(file), 401                  |

## Доменные правила

* Подписка на себя → 400 `{ "detail": "Нельзя подписаться на себя" }`
* Повторное добавление в избранное/корзину → 400/409 `{ "detail": "Уже добавлено" }`
* Удаление чужого рецепта → 403 `{ "detail": "You do not have permission to perform this action." }`

## Хендлеры

* 401 Unauthorized: `{ "detail": "Invalid token." }`
* 403 Forbidden: `{ "detail": "You do not have permission to perform this action." }`
* 404 Not Found: `{ "detail": "Not found." }`

> Для валидации можно либо оставить FastAPI‑422, либо конвертировать в DRF‑стиль (400 с полями). Главное — одинаково везде.
